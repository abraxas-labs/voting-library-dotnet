// (c) Copyright 2024 by Abraxas Informatik AG
// For license information see LICENSE file

namespace Voting.Lib.MalwareScanner.Models.Internal;
internal class MalwareScannerResponse
{
    private const string MalwareFoundResult = "MALWARE";
    private const string NoMalwareFoundResult = "NONE";

    public string? Result { get; set; }

    public string? Name { get; set; }

    public string GetMalwareDescription()
    {
        if (Result == MalwareFoundResult)
        {
            Name ??= "without specific name";

            return Result + " - malware detected: " + Name;
        }

        return Result + " - no Malware detected";
    }

    public bool NoMalwareDetected()
    {
        return Result == NoMalwareFoundResult;
    }

    public bool ResultIsValid()
    {
        return Result == MalwareFoundResult || Result == NoMalwareFoundResult;
    }
}
